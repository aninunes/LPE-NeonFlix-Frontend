{"ast":null,"code":"import{useState,useEffect}from\"react\";import FilmeContext from\"./FilmeContext\";import{getFilmesAPI,getFilmePorIdAPI,deleteFilmePorIdAPI,cadastrarFilmeAPI}from\"../../../servicos/FilmeServico\";import Tabela from\"./Tabela\";import Carregando from\"../../comuns/Carregando\";import Form from\"./Form\";import WithAuth from\"../../../seguranca/WithAuth\";import{useNavigate}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Filme(){let navigate=useNavigate();const[alerta,setAlerta]=useState({status:\"\",message:\"\"});const[listaObjetos,setListaObjetos]=useState([]);const[editar,setEditar]=useState(false);const[objeto,setObjeto]=useState({id:\"\",titulo:\"\",descricao:\"\",ano_lancamento:\"\",genero_id:\"\",genero_nome:\"\"});const[carregando,setCarregando]=useState(true);const novoObjeto=()=>{setEditar(false);setAlerta({status:\"\",message:\"\"});setObjeto({id:0,titulo:\"\",descricao:\"\",ano_lancamento:\"\",genero_id:\"\",genero_nome:\"\"});};const editarObjeto=async id=>{try{const dados=await getFilmePorIdAPI(id);setObjeto(dados);setEditar(true);setAlerta({status:\"\",message:\"\"});}catch(err){window.location.reload();navigate(\"/login\",{replace:true});}};const acaoCadastrar=async e=>{e.preventDefault();let metodo=editar?\"PUT\":\"POST\";try{let retornoAPI=await cadastrarFilmeAPI(metodo,objeto);setAlerta({status:retornoAPI.status,message:retornoAPI.message});setObjeto(retornoAPI.objeto);if(!editar){setEditar(true);}recuperaFilmes();}catch(err){window.location.reload();navigate(\"/login\",{replace:true});}};const handleChange=e=>{const name=e.target.name;const value=e.target.value;setObjeto({...objeto,[name]:value});};const recuperaFilmes=async()=>{try{setCarregando(true);const dados=await getFilmesAPI();console.log(\"Dados recebidos:\",dados);// Adicionei detalhes ao log\nsetListaObjetos(dados);setCarregando(false);}catch(err){window.location.reload();navigate(\"/login\",{replace:true});}};const remover=async id=>{if(window.confirm('Deseja remover este objeto?')){try{let retornoAPI=await deleteFilmePorIdAPI(id);setAlerta({status:retornoAPI.status,message:retornoAPI.message});recuperaFilmes();}catch(err){window.location.reload();navigate(\"/login\",{replace:true});}}};useEffect(()=>{recuperaFilmes();},[]);return/*#__PURE__*/_jsxs(FilmeContext.Provider,{value:{alerta,listaObjetos,remover,objeto,editar,acaoCadastrar,handleChange,novoObjeto,editarObjeto},children:[/*#__PURE__*/_jsx(Carregando,{carregando:carregando,children:/*#__PURE__*/_jsx(Tabela,{})}),/*#__PURE__*/_jsx(Form,{})]});}export default WithAuth(Filme);","map":{"version":3,"names":["useState","useEffect","FilmeContext","getFilmesAPI","getFilmePorIdAPI","deleteFilmePorIdAPI","cadastrarFilmeAPI","Tabela","Carregando","Form","WithAuth","useNavigate","jsx","_jsx","jsxs","_jsxs","Filme","navigate","alerta","setAlerta","status","message","listaObjetos","setListaObjetos","editar","setEditar","objeto","setObjeto","id","titulo","descricao","ano_lancamento","genero_id","genero_nome","carregando","setCarregando","novoObjeto","editarObjeto","dados","err","window","location","reload","replace","acaoCadastrar","e","preventDefault","metodo","retornoAPI","recuperaFilmes","handleChange","name","target","value","console","log","remover","confirm","Provider","children"],"sources":["C:/Users/anita/Music/LPE/Frontend/src/componentes/telas/filme/Filme.jsx"],"sourcesContent":["import { useState, useEffect } from \"react\";\r\nimport FilmeContext from \"./FilmeContext\";\r\nimport {\r\n    getFilmesAPI, getFilmePorIdAPI,\r\n    deleteFilmePorIdAPI, cadastrarFilmeAPI\r\n} from \"../../../servicos/FilmeServico\";\r\nimport Tabela from \"./Tabela\";\r\nimport Carregando from \"../../comuns/Carregando\";\r\nimport Form from \"./Form\";\r\nimport WithAuth from \"../../../seguranca/WithAuth\";\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\nfunction Filme() {\r\n\r\n    let navigate = useNavigate();\r\n\r\n    const [alerta, setAlerta] = useState({ status: \"\", message: \"\" });\r\n    const [listaObjetos, setListaObjetos] = useState([]);\r\n    const [editar, setEditar] = useState(false);\r\n    const [objeto, setObjeto] = useState({ id: \"\", titulo: \"\", descricao: \"\", ano_lancamento: \"\", genero_id: \"\", genero_nome: \"\" });\r\n    const [carregando, setCarregando] = useState(true);\r\n\r\n    const novoObjeto = () => {\r\n        setEditar(false);\r\n        setAlerta({ status: \"\", message: \"\" });\r\n        setObjeto({ id: 0, titulo: \"\", descricao: \"\", ano_lancamento: \"\", genero_id: \"\", genero_nome: \"\" });\r\n    }\r\n\r\n    const editarObjeto = async id => {\r\n        try {\r\n            const dados = await getFilmePorIdAPI(id);\r\n            setObjeto(dados);\r\n            setEditar(true);\r\n            setAlerta({ status: \"\", message: \"\" });\r\n        } catch (err) {\r\n            window.location.reload();\r\n            navigate(\"/login\", { replace: true });\r\n        }\r\n    }\r\n\r\n    const acaoCadastrar = async e => {\r\n        e.preventDefault();\r\n        let metodo = editar ? \"PUT\" : \"POST\";\r\n        try {\r\n            let retornoAPI = await cadastrarFilmeAPI(metodo, objeto);\r\n            setAlerta({ status: retornoAPI.status, message: retornoAPI.message });\r\n            setObjeto(retornoAPI.objeto);\r\n            if (!editar) {\r\n                setEditar(true);\r\n            }\r\n            recuperaFilmes();\r\n        } catch (err) {\r\n            window.location.reload();\r\n            navigate(\"/login\", { replace: true });\r\n        }\r\n    }\r\n\r\n    const handleChange = (e) => {\r\n        const name = e.target.name;\r\n        const value = e.target.value;\r\n        setObjeto({ ...objeto, [name]: value });\r\n    }\r\n\r\n    const recuperaFilmes = async () => {\r\n        try {\r\n            setCarregando(true);\r\n            const dados = await getFilmesAPI();\r\n            console.log(\"Dados recebidos:\", dados); // Adicionei detalhes ao log\r\n            setListaObjetos(dados);\r\n            setCarregando(false);\r\n        } catch (err) {\r\n            window.location.reload();\r\n            navigate(\"/login\", { replace: true });\r\n        }\r\n    }\r\n    \r\n    \r\n\r\n    const remover = async id => {\r\n        if (window.confirm('Deseja remover este objeto?')) {\r\n            try {\r\n                let retornoAPI = await deleteFilmePorIdAPI(id);\r\n                setAlerta({ status: retornoAPI.status, message: retornoAPI.message });\r\n                recuperaFilmes();\r\n            } catch (err) {\r\n                window.location.reload();\r\n                navigate(\"/login\", { replace: true });\r\n            }\r\n        }\r\n    }\r\n\r\n    useEffect(() => {\r\n        recuperaFilmes();\r\n    }, []);\r\n\r\n\r\n    return (\r\n        <FilmeContext.Provider value={{\r\n            alerta, listaObjetos, remover,\r\n            objeto, editar, acaoCadastrar, handleChange, novoObjeto, editarObjeto\r\n        }}>\r\n            <Carregando carregando={carregando}>\r\n                <Tabela />\r\n            </Carregando>\r\n            <Form />\r\n        </FilmeContext.Provider>\r\n    )\r\n}\r\n\r\nexport default WithAuth(Filme);\r\n"],"mappings":"AAAA,OAASA,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAC3C,MAAO,CAAAC,YAAY,KAAM,gBAAgB,CACzC,OACIC,YAAY,CAAEC,gBAAgB,CAC9BC,mBAAmB,CAAEC,iBAAiB,KACnC,gCAAgC,CACvC,MAAO,CAAAC,MAAM,KAAM,UAAU,CAC7B,MAAO,CAAAC,UAAU,KAAM,yBAAyB,CAChD,MAAO,CAAAC,IAAI,KAAM,QAAQ,CACzB,MAAO,CAAAC,QAAQ,KAAM,6BAA6B,CAClD,OAASC,WAAW,KAAQ,kBAAkB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE/C,QAAS,CAAAC,KAAKA,CAAA,CAAG,CAEb,GAAI,CAAAC,QAAQ,CAAGN,WAAW,CAAC,CAAC,CAE5B,KAAM,CAACO,MAAM,CAAEC,SAAS,CAAC,CAAGnB,QAAQ,CAAC,CAAEoB,MAAM,CAAE,EAAE,CAAEC,OAAO,CAAE,EAAG,CAAC,CAAC,CACjE,KAAM,CAACC,YAAY,CAAEC,eAAe,CAAC,CAAGvB,QAAQ,CAAC,EAAE,CAAC,CACpD,KAAM,CAACwB,MAAM,CAAEC,SAAS,CAAC,CAAGzB,QAAQ,CAAC,KAAK,CAAC,CAC3C,KAAM,CAAC0B,MAAM,CAAEC,SAAS,CAAC,CAAG3B,QAAQ,CAAC,CAAE4B,EAAE,CAAE,EAAE,CAAEC,MAAM,CAAE,EAAE,CAAEC,SAAS,CAAE,EAAE,CAAEC,cAAc,CAAE,EAAE,CAAEC,SAAS,CAAE,EAAE,CAAEC,WAAW,CAAE,EAAG,CAAC,CAAC,CAC/H,KAAM,CAACC,UAAU,CAAEC,aAAa,CAAC,CAAGnC,QAAQ,CAAC,IAAI,CAAC,CAElD,KAAM,CAAAoC,UAAU,CAAGA,CAAA,GAAM,CACrBX,SAAS,CAAC,KAAK,CAAC,CAChBN,SAAS,CAAC,CAAEC,MAAM,CAAE,EAAE,CAAEC,OAAO,CAAE,EAAG,CAAC,CAAC,CACtCM,SAAS,CAAC,CAAEC,EAAE,CAAE,CAAC,CAAEC,MAAM,CAAE,EAAE,CAAEC,SAAS,CAAE,EAAE,CAAEC,cAAc,CAAE,EAAE,CAAEC,SAAS,CAAE,EAAE,CAAEC,WAAW,CAAE,EAAG,CAAC,CAAC,CACvG,CAAC,CAED,KAAM,CAAAI,YAAY,CAAG,KAAM,CAAAT,EAAE,EAAI,CAC7B,GAAI,CACA,KAAM,CAAAU,KAAK,CAAG,KAAM,CAAAlC,gBAAgB,CAACwB,EAAE,CAAC,CACxCD,SAAS,CAACW,KAAK,CAAC,CAChBb,SAAS,CAAC,IAAI,CAAC,CACfN,SAAS,CAAC,CAAEC,MAAM,CAAE,EAAE,CAAEC,OAAO,CAAE,EAAG,CAAC,CAAC,CAC1C,CAAE,MAAOkB,GAAG,CAAE,CACVC,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC,CAAC,CACxBzB,QAAQ,CAAC,QAAQ,CAAE,CAAE0B,OAAO,CAAE,IAAK,CAAC,CAAC,CACzC,CACJ,CAAC,CAED,KAAM,CAAAC,aAAa,CAAG,KAAM,CAAAC,CAAC,EAAI,CAC7BA,CAAC,CAACC,cAAc,CAAC,CAAC,CAClB,GAAI,CAAAC,MAAM,CAAGvB,MAAM,CAAG,KAAK,CAAG,MAAM,CACpC,GAAI,CACA,GAAI,CAAAwB,UAAU,CAAG,KAAM,CAAA1C,iBAAiB,CAACyC,MAAM,CAAErB,MAAM,CAAC,CACxDP,SAAS,CAAC,CAAEC,MAAM,CAAE4B,UAAU,CAAC5B,MAAM,CAAEC,OAAO,CAAE2B,UAAU,CAAC3B,OAAQ,CAAC,CAAC,CACrEM,SAAS,CAACqB,UAAU,CAACtB,MAAM,CAAC,CAC5B,GAAI,CAACF,MAAM,CAAE,CACTC,SAAS,CAAC,IAAI,CAAC,CACnB,CACAwB,cAAc,CAAC,CAAC,CACpB,CAAE,MAAOV,GAAG,CAAE,CACVC,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC,CAAC,CACxBzB,QAAQ,CAAC,QAAQ,CAAE,CAAE0B,OAAO,CAAE,IAAK,CAAC,CAAC,CACzC,CACJ,CAAC,CAED,KAAM,CAAAO,YAAY,CAAIL,CAAC,EAAK,CACxB,KAAM,CAAAM,IAAI,CAAGN,CAAC,CAACO,MAAM,CAACD,IAAI,CAC1B,KAAM,CAAAE,KAAK,CAAGR,CAAC,CAACO,MAAM,CAACC,KAAK,CAC5B1B,SAAS,CAAC,CAAE,GAAGD,MAAM,CAAE,CAACyB,IAAI,EAAGE,KAAM,CAAC,CAAC,CAC3C,CAAC,CAED,KAAM,CAAAJ,cAAc,CAAG,KAAAA,CAAA,GAAY,CAC/B,GAAI,CACAd,aAAa,CAAC,IAAI,CAAC,CACnB,KAAM,CAAAG,KAAK,CAAG,KAAM,CAAAnC,YAAY,CAAC,CAAC,CAClCmD,OAAO,CAACC,GAAG,CAAC,kBAAkB,CAAEjB,KAAK,CAAC,CAAE;AACxCf,eAAe,CAACe,KAAK,CAAC,CACtBH,aAAa,CAAC,KAAK,CAAC,CACxB,CAAE,MAAOI,GAAG,CAAE,CACVC,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC,CAAC,CACxBzB,QAAQ,CAAC,QAAQ,CAAE,CAAE0B,OAAO,CAAE,IAAK,CAAC,CAAC,CACzC,CACJ,CAAC,CAID,KAAM,CAAAa,OAAO,CAAG,KAAM,CAAA5B,EAAE,EAAI,CACxB,GAAIY,MAAM,CAACiB,OAAO,CAAC,6BAA6B,CAAC,CAAE,CAC/C,GAAI,CACA,GAAI,CAAAT,UAAU,CAAG,KAAM,CAAA3C,mBAAmB,CAACuB,EAAE,CAAC,CAC9CT,SAAS,CAAC,CAAEC,MAAM,CAAE4B,UAAU,CAAC5B,MAAM,CAAEC,OAAO,CAAE2B,UAAU,CAAC3B,OAAQ,CAAC,CAAC,CACrE4B,cAAc,CAAC,CAAC,CACpB,CAAE,MAAOV,GAAG,CAAE,CACVC,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC,CAAC,CACxBzB,QAAQ,CAAC,QAAQ,CAAE,CAAE0B,OAAO,CAAE,IAAK,CAAC,CAAC,CACzC,CACJ,CACJ,CAAC,CAED1C,SAAS,CAAC,IAAM,CACZgD,cAAc,CAAC,CAAC,CACpB,CAAC,CAAE,EAAE,CAAC,CAGN,mBACIlC,KAAA,CAACb,YAAY,CAACwD,QAAQ,EAACL,KAAK,CAAE,CAC1BnC,MAAM,CAAEI,YAAY,CAAEkC,OAAO,CAC7B9B,MAAM,CAAEF,MAAM,CAAEoB,aAAa,CAAEM,YAAY,CAAEd,UAAU,CAAEC,YAC7D,CAAE,CAAAsB,QAAA,eACE9C,IAAA,CAACL,UAAU,EAAC0B,UAAU,CAAEA,UAAW,CAAAyB,QAAA,cAC/B9C,IAAA,CAACN,MAAM,GAAE,CAAC,CACF,CAAC,cACbM,IAAA,CAACJ,IAAI,GAAE,CAAC,EACW,CAAC,CAEhC,CAEA,cAAe,CAAAC,QAAQ,CAACM,KAAK,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}